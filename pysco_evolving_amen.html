

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The Amen Break Scorc Tutorial &mdash; CSD</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.5 alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="CSD" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">CSD</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3>Get CSD</h3>
<ul id="downloadrepo">
    <li><a href="https://github.com/jacobjoaquin/csd/zipball/master">Download <strong>ZIP File</strong></a></li>
    <li><a href="https://github.com/jacobjoaquin/csd/tarball/master">Download <strong>TAR Ball</strong></a></li>
    <li><a href="https://github.com/jacobjoaquin/csd">View On <strong>GitHub</strong></a></li>
</ul>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Amen Break Scorc Tutorial</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#the-orchestra">The Orchestra</a></li>
<li><a class="reference internal" href="#the-python-interpretor">The Python Interpretor</a></li>
<li><a class="reference internal" href="#seeing-the-generated-classical-score">Seeing the Generated Classical Score</a></li>
</ul>
</li>
<li><a class="reference internal" href="#from-the-classical-score-to-python-score">From the Classical Score to Python Score</a><ul>
<li><a class="reference internal" href="#upgrade">Upgrade</a></li>
<li><a class="reference internal" href="#time-is-relative">Time is Relative</a></li>
<li><a class="reference internal" href="#measures">Measures</a></li>
<li><a class="reference internal" href="#instrument-event-function">Instrument Event Function</a></li>
<li><a class="reference internal" href="#nesting-time">Nesting Time</a></li>
<li><a class="reference internal" href="#score-instruments">Score Instruments</a></li>
<li><a class="reference internal" href="#drum-pattern">Drum Pattern</a></li>
<li><a class="reference internal" href="#interlude">Interlude</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-score-development">Further Score Development</a><ul>
<li><a class="reference internal" href="#looping-through-lists">Looping Through Lists</a></li>
<li><a class="reference internal" href="#range">Range</a></li>
<li><a class="reference internal" href="#choice-variation">Choice Variation</a></li>
<li><a class="reference internal" href="#hats">Hats</a></li>
<li><a class="reference internal" href="#post-processing-with-pmap">Post Processing with pmap()</a></li>
<li><a class="reference internal" href="#pre-processing-events-with-p-callback">Pre-processing Events with p_callback()</a></li>
<li><a class="reference internal" href="#transpose">Transpose</a></li>
<li><a class="reference internal" href="#default-values-for-score-instruments">Default Values for Score Instruments</a></li>
<li><a class="reference internal" href="#player-instruments">Player Instruments</a></li>
<li><a class="reference internal" href="#algorithmic-flair-drum-pattern">Algorithmic Flair Drum Pattern</a></li>
<li><a class="reference internal" href="#form-with-functions">Form With Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/pysco_evolving_amen.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-amen-break-scorc-tutorial">
<h1>The Amen Break Scorc Tutorial<a class="headerlink" href="#the-amen-break-scorc-tutorial" title="Permalink to this headline">¶</a></h1>
<p>By Jacob Joaquin <a class="reference external" href="mailto:jacobjoaquin&#37;&#52;&#48;gmail&#46;com">jacobjoaquin<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><em>&#8220;Y&#8217;all ready for this?&#8221;</em> - Michael J. Nelson <a class="footnote-reference" href="#michaeljnelson" id="id1">[1]</a></p>
<p>Python Score, or Pysco for short, is a fully modular score environment
for the Csound unified CSD file. Unlike other alternative text-based
score environements, Pysco is non-imposing and does its best to get
out of the way rather than to impose a strict set of rules for
composition. Classical Csound score is fully supported, all of
Python 2.7 is available, and composers can pick and choose their
score tools A La Carte as the see fit.</p>
<p>This purpose of this tutorial is to try and prove the merits of
using the Python language in favor of the classical Csound score.
The classical score is a fixed system while Python is a very mature
and highly extensible language with a vast collection of first and
third party modules. Despite being a general purpose language that
wasn&#8217;t designed for music, Python is particularly well suited for
compostion.</p>
<p>It should be noted that Python Score is not meant as a full replacement
of the classical Csound score, but as an enhancement. Any and all
existing classical score commands still work, and Python Score
itself outputs classical score code. Perhaps Python Score should
be thought as a user-friendly higher level abstraction of the classic
score, as is the case with Processing and Java.</p>
<p>Python Score is still early in development, though the library of
use cases and examples are rapidly growing, and all from a single
developer. The secondary purpose of this tutorial is to attract a
small group of people to start experimenting with this alternative
Csound score environment, to find out what works, what&#8217;s easy and
what&#8217;s not, and to collect new ideas for future upgrades. It is
also the belief of the author that once people have some hands-on
experience, many of the advantages of working with Python Score
will become obvious. Until then, it&#8217;s just the ramblings of one
person&#8217;s perspective.</p>
<p>Since Pysco is under development, consider this tutorial a living
document, and be updated to keep up with any changes. Send questions,
comments, and bugs to <a class="reference external" href="mailto:jacobjoaquin&#37;&#52;&#48;gmail&#46;com">jacobjoaquin<span>&#64;</span>gmail<span>&#46;</span>com</a>, or write to the Csound
Mailing List.</p>
<div class="section" id="the-orchestra">
<h3>The Orchestra<a class="headerlink" href="#the-orchestra" title="Permalink to this headline">¶</a></h3>
<p>In order to bring focus to the enhanced set of features and
compositional techniques Python and the Pysco module brings to the
score, every example uses the exact same orchestra throughout the
entirety of this tutorial. Let&#8217;s quickly review:</p>
<div class="highlight-python"><pre>
sr = 44100
kr = 44100
ksmps = 1
nchnls = 2
0dbfs = 1.0

gS_loop = "amen_break.wav"
gisr filesr gS_loop
gilength filelen gS_loop
gibeats = 16 
gi_sampleleft ftgen 1, 0, 0, 1, gS_loop, 0, 4, 0

instr 1
    idur = p3
    iamp = p4
    ibeat = p5
    itune = p6
    ipos = ibeat / gibeats * gilength * gisr

    aenv linseg iamp, idur - 0.01, iamp, 0.01, 0
    a1, a2 loscilx aenv, itune, 1, 0, 1, ipos, 0
    outs a1, a2
endin

</pre>
</div>
<p>The orchestra contains only a single instrument, a basic sampler
with the Amen Break <a class="footnote-reference" href="#amen" id="id2">[2]</a> as its only audio source. The instrument
includes support for three custom pfield insputs for amplitude, the
starting position in the sample (in beats), and for tuning the
sample. The fact that this is only a very basic instrument is on
purpose, as techniques discusse will include that even very simple
intruments can be enhanced using the newly available score functions.</p>
<p>The output of this device has a very trashy <a class="footnote-reference" href="#trashy" id="id3">[3]</a> quality to
it, and sounds like it was produced with a tracker <a class="footnote-reference" href="#tracker" id="id4">[4]</a> such
as Fast Tracker II.</p>
<p>There&#8217;s also a reason for using a drum loop as an example. The
ability to express time and occurances in time is a defining attribute
of Python score, and percussion-based events are great for honing
in on timing. <em>Do not get the wrong impressiong that Python Score caters
to 4/4 drumming music, as this is far from the truth.</em></p>
</div>
<div class="section" id="the-python-interpretor">
<h3>The Python Interpretor<a class="headerlink" href="#the-python-interpretor" title="Permalink to this headline">¶</a></h3>
<p>Before moving into the tutorial, an introduction the the Python
Interpretor is in order as it a wonderful tool for quickly testing
various aspects of the Python language. This tutorial will occasionaly
use this as well.</p>
<p>Typically, the Python interpretor is used in the terminal, which
is invoked by typing &#8220;python&#8221;:</p>
<div class="highlight-python"><pre>Quorra ~ $ python</pre>
</div>
<p>This will starts an interactive Python session in which users can
start entering various commands.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;hello world&#39;</span>
<span class="go">hello world</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">440</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="go">261.6255653005986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
<p>The <a class="reference external" href="http://qutecsound.sourceforge.net/">CsoundQt</a> graphical front
end comes equimed with a Python console. There&#8217;s also <a class="reference external" href="http://ipython.org/">IPython</a> which supercharges the Python Interpretor
with a lot of great features for Python beginners and veterans
alike.</p>
</div>
<div class="section" id="seeing-the-generated-classical-score">
<h3>Seeing the Generated Classical Score<a class="headerlink" href="#seeing-the-generated-classical-score" title="Permalink to this headline">¶</a></h3>
<p>Python Score writes a copy of the generated score to a fild called
_pysco.sco. This is good to know in case you want to see exactly
what Python Score is doing, or need to debug an issues that arises.</p>
</div>
</div>
<div class="section" id="from-the-classical-score-to-python-score">
<h2>From the Classical Score to Python Score<a class="headerlink" href="#from-the-classical-score-to-python-score" title="Permalink to this headline">¶</a></h2>
<p>In this section, the will walk you through some the more basic
features of Python Score. The tutorial starts with a classical
Csound score, and adds new Python Score idioums one by one until
the score as been fully translated. The end result is the new Python
score.</p>
<div class="highlight-python"><pre>
t 0 170

; Measure 1
i 1 0.0 0.5 0.707 0 1
i 1 1.0 0.5 0.707 1 1
i 1 2.5 0.5 0.707 0 1
i 1 3.0 0.5 0.707 1 1

; Measure 2
i 1 4.0 0.5 0.707 0 1
i 1 5.0 0.5 0.707 1 1
i 1 6.5 0.5 0.707 0 1
i 1 7.0 0.5 0.707 1 1

; Measure 3
i 1 8.0  0.5 0.707 0 1
i 1 9.0  0.5 0.707 1 1
i 1 10.5 0.5 0.707 0 1
i 1 11.0 0.5 0.707 1 1

; Measure 4
i 1 12.0 0.5 0.707 0 1
i 1 13.0 0.5 0.707 1 1
i 1 14.5 0.5 0.707 0 1
i 1 15.0 0.5 0.707 1 1

</pre>
</div>
<p>The score code produces 4 measures of the same drum pattern. The
pattern itself is the classical drum &#8216;n&#8217; bass. <a class="footnote-reference" href="#dnb" id="id5">[5]</a></p>
<p>AUDIO HERE</p>
<div class="section" id="upgrade">
<h3>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h3>
<p>Porting a classical score into the Python Score environment requires
only two changes. First, one needs to set the argument of the CsScore
bin utility to &#8220;python pysco.py&#8221;. Second, the classical score code
needs to be passed as a string to the score() object. These changes
result in the followin Python Score code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">CsScore</span> <span class="nb">bin</span><span class="o">=</span><span class="s">&quot;python&quot;</span><span class="o">&gt;</span>

<span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">t 0 170</span>

<span class="s">; Measure 1</span>
<span class="s">i 1 0.0 0.5 0.707 0 1</span>
<span class="s">i 1 1.0 0.5 0.707 1 1</span>
<span class="s">i 1 2.5 0.5 0.707 0 1</span>
<span class="s">i 1 3.0 0.5 0.707 1 1</span>

<span class="s">; Measure 2</span>
<span class="s">i 1 4.0 0.5 0.707 0 1</span>
<span class="s">i 1 5.0 0.5 0.707 1 1</span>
<span class="s">i 1 6.5 0.5 0.707 0 1</span>
<span class="s">i 1 7.0 0.5 0.707 1 1</span>

<span class="s">; Measure 3</span>
<span class="s">i 1 8.0  0.5 0.707 0 1</span>
<span class="s">i 1 9.0  0.5 0.707 1 1</span>
<span class="s">i 1 10.5 0.5 0.707 0 1</span>
<span class="s">i 1 11.0 0.5 0.707 1 1</span>

<span class="s">; Measure 4</span>
<span class="s">i 1 12.0 0.5 0.707 0 1</span>
<span class="s">i 1 13.0 0.5 0.707 1 1</span>
<span class="s">i 1 14.5 0.5 0.707 0 1</span>
<span class="s">i 1 15.0 0.5 0.707 1 1</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>

<span class="o">&lt;/</span><span class="n">CsScore</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">CsoundSynthesizer</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If you are worried that you would have to throw out everything you
know about the classic Csound score, fear not because you can still
use it with the score() object  virtually untouched, or in combination
with other Python features as you learn them.</p>
</div>
<div class="section" id="time-is-relative">
<h3>Time is Relative<a class="headerlink" href="#time-is-relative" title="Permalink to this headline">¶</a></h3>
<p><em>&#8220;It&#8217;s what makes time travel possible.&#8221;</em> - Dr. Emmett Lathrop Brown
<a class="footnote-reference" href="#fluxcapacitor" id="id6">[7]</a></p>
<p>For the most part, when events are entered into a classical Csound
score, the start times are in global beats. Python Score changes
with by introducing the cue() object, which is a Python context
manager for moving the current postion in time in the score. All
events entered into Python Score are relative the current positional
value of the cue().</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">score</span><span class="p">(</span><span class="s">&#39;i 1 0 0.5 0.707 0 0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>While the start time value in pfield 2 is 0, this event will start
at 12 beats into the piece. This is because start time events are
process to reflect the current position of the cue(). The output
looks like this:</p>
<div class="highlight-python"><pre>i 1 12 0.5 0.707 0 0</pre>
</div>
<p>As for translating the drum &#8216;n&#8217; bass parts, each measure has been
split into its own chuck of events. The first event in measure 2
has been changed to 0.0, and the same goes for measures 3 and 4.
The cue() object allows the composer to think of time local to the
current measure, rather than manually calculate the global time.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p>There are of course many more benefits. For example, moving entire
sections of code is a fairly trivial process in Pysco. Doing the
same in the classical score could require translating start times
down a long pfield 2 column. It is the assertion of the author that
this feature, and this feature alone, makes transitioning to Python
Score more than worthwhile.</p>
</div>
<div class="section" id="measures">
<h3>Measures<a class="headerlink" href="#measures" title="Permalink to this headline">¶</a></h3>
<p>The drum &#8216;n&#8217; bass score is in 4/4. While the cue() object allows
us to treat beats local to the current measure, the arguments for
the cue() are in absolute global time in the previous section. Out
of the box, Python Score does not support measures. However, Python
lets you <em>roll your own</em>. Implementing 4/4 measures is done by
<a class="reference external" href="http://docs.python.org/2/tutorial/controlflow.html#defining-functions">defining a new function</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
<p>This two line custom function takes the measure number as its sole
argument and translates measure time to beat time, and returns an
instance of cue().</p>
<p><em>&#8220;Mathematical!&#8221;</em> - Jake the Human <a class="footnote-reference" href="#adventuretime" id="id7">[8]</a></p>
<p>Let&#8217;s focus little on the math. The global score starts at 0, but
measures start at 1. The is overcome with an offset of -1. In 4/4,
there are four beats per measure, which requires the offset value
to be multplied by 4. Testing the math in the Python Interpretor
with inputting 4:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test_my_math</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_my_math</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">12.0</span>
</pre></div>
</div>
<p>The value returned is 12, which is the starting time of the first
event in measure 4 in the original classical score. Applying measure()
to the Python score, were left with the following. Notice that the
comments have been factored out now that the code itself clearly
indicates what a measure is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="instrument-event-function">
<h3>Instrument Event Function<a class="headerlink" href="#instrument-event-function" title="Permalink to this headline">¶</a></h3>
<p>The event_i() function is another way for entering in data into the
score. Instead of a string, it accepts any number of arguments and
constructs a valid classical score event string. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><pre>i 1 0 1 0.707 8.00</pre>
</div>
<p>Replacing the calls to score() with event_i in the Amen score, the
updated code looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="nesting-time">
<h3>Nesting Time<a class="headerlink" href="#nesting-time" title="Permalink to this headline">¶</a></h3>
<p>A <tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statement can be placed inside a heiarchy of other
<tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statements. This allows composers to reset the
relative positional time to 0 regardless of the current scope of
time by writing another <tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statement: For example, this
is possible:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">event_i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Though the start time of the event is written as 0, the actual start
time of the event is 37, which is the cumulation of all the args
in the cue nesting hierarchy plus pfield 2: <tt class="docutils literal"><span class="pre">32</span> <span class="pre">+</span> <span class="pre">4</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">0</span></tt></p>
<p>The greater implication is that time can be completely decoupled
from the event within the code. In this version of the score the
start times are moved from the pfield 2 column to the the <tt class="docutils literal"><span class="pre">cue()</span></tt>,
and then set to 0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p>The code right is a little messy, but this will be cleaned up.</p>
</div>
<div class="section" id="score-instruments">
<h3>Score Instruments<a class="headerlink" href="#score-instruments" title="Permalink to this headline">¶</a></h3>
<p>Composers can create named Python functions that call their
corresponding orchestra instruments. Furthermore, multiple functions
can be created to the same instrument, but with more specific intent
as to the resulting behavoir of the intruments.</p>
<p>The sampler instrument in the orchestra is fairly simple and generic
in design. While the Amen Break loop is fixed, the instrument itself
has no knowledge of kicks or hats. It only accesses the part of the
sample denoted by the positional value passed in through pfield-5.</p>
<p>Looking at the Python Score code from the last example, there are
only two unique calls to score.i(), and even then all the arguments
are identical except for pfield-5:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The former plays a kick drum while the latter plays a snare. Though
looking at the code you might not know which is which and who is
who. <a class="footnote-reference" href="#darksideofthemoon" id="id8">[9]</a> This is because the difference is just
the data used in pfield 5.</p>
<p>These statements are also unnecessirly long in Python and are ripe
to for consolidation. Defining functions for the kick and snare
avoids the extra overhead by factoring out all the args. Something
is made possible by the <tt class="docutils literal"><span class="pre">cue()</span></tt> object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>An equally important benefit to this approach is that with proper
names, this techinique creates code that is self documenting and
easier to read. If you type kick() it plays a kick. Type snare()
it plays a snare. Type snozberry() it plays a snozberry(). <a class="footnote-reference" href="#snozberry" id="id9">[6]</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="drum-pattern">
<h3>Drum Pattern<a class="headerlink" href="#drum-pattern" title="Permalink to this headline">¶</a></h3>
<p>The score contains four measures that contain identical content.
Functions can store musical phrases, everything from a single note
to complete works of Beethoven if necessary. In this case, we have
a simple 4 notes drum &#8216;n&#8217; bass pattern.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
</pre></div>
</div>
<p>These events will not be generated until the function is accessed.
For each measure, four lines of score instruments is replaced with
drum_pattern().</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">drum_pattern</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p>Functions aren&#8217;t limited to storing measures of data. Notes, licks,
phrases, bars, sections, entire scores, can all be placed inside a
function. Later when it&#8217;s time to start arranging, musical patterns
like these can be more or less dropped into <tt class="docutils literal"><span class="pre">measure()</span></tt> blocks.</p>
</div>
<div class="section" id="interlude">
<h3>Interlude<a class="headerlink" href="#interlude" title="Permalink to this headline">¶</a></h3>
<p>This is a good moment to pause and take a close look at the concepts introduced.</p>
<ul class="simple">
<li>Data to structure</li>
<li>fundamentally more expressive (which is a good thing with music)</li>
<li>Even if you don&#8217;t know python, this is fundamentally more readable</li>
<li>Definitely read on, but practice the preceeding examples</li>
<li>Everything you can do with the classical score you can do in Python Score. The opposite isn&#8217;t true (not even close)</li>
</ul>
<p>The score we&#8217;re left with is fundamentally more readable than the original Csound score. The fact that drums are being played is much more obvious than in the original classical score.</p>
<p>Starting with the next section</p>
</div>
</div>
<div class="section" id="further-score-development">
<h2>Further Score Development<a class="headerlink" href="#further-score-development" title="Permalink to this headline">¶</a></h2>
<p>Python is an open-ended highly extensible language which allows
many new ways to developer a highly personalized score environment.
In the examples to come, new features and musical phrases are built
on top of the existing work covered in the previous examples. The
orchestra will remain unchanged, though the music will.</p>
<div class="section" id="looping-through-lists">
<h3>Looping Through Lists<a class="headerlink" href="#looping-through-lists" title="Permalink to this headline">¶</a></h3>
<p>A list is a Python container for storing various data, which may
include numbers, strings, other lists, functions, etc. And they
make a wonderful additional to the score environment. They&#8217;re highly
versatile and time saving. This example is a list of integers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>A loop is created from a list with the <tt class="docutils literal"><span class="pre">for</span></tt> statment, as it will
iterate through each value. In the score as the <tt class="docutils literal"><span class="pre">for</span></tt> loop iterates
through the list, the <tt class="docutils literal"><span class="pre">m</span></tt> variable assumes the the value of the
current list item. This is shorthand for calling <tt class="docutils literal"><span class="pre">drum_pattern()</span></tt>
for measures 1 through 4:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="range">
<h3>Range<a class="headerlink" href="#range" title="Permalink to this headline">¶</a></h3>
<p>The Python <tt class="docutils literal"><span class="pre">range()</span></tt> generates lists of integers automatically
and is useful in a range of different contexts. Here are three
examples of lists generated with <tt class="docutils literal"><span class="pre">range()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">[4, 5, 6, 7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[0, 4, 8, 12, 16, 20, 24, 28]</span>
</pre></div>
</div>
<p>Substituting that manually created list with <tt class="docutils literal"><span class="pre">range()</span></tt> leaves us
with this update to the loop in the score.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="choice-variation">
<h3>Choice Variation<a class="headerlink" href="#choice-variation" title="Permalink to this headline">¶</a></h3>
<p>Python comes with the random module which includes the <tt class="docutils literal"><span class="pre">choice()</span></tt>
function that returns a random value from a list. Prior to this
example, all kick and snare events use the sample from the Amen
break. Applied to the <tt class="docutils literal"><span class="pre">kick()</span></tt> and <tt class="docutils literal"><span class="pre">snare()</span></tt> score instruments,
these functions randomly choose samples from a fixed list of positions
in the drum loop.</p>
<p>The <tt class="docutils literal"><span class="pre">kick()</span></tt> function chooses from positions 0, 0.5, 4, and 4.5:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">snare()</span></tt> functions chooses from positions 1, 3, 5, and 7:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="hats">
<h3>Hats<a class="headerlink" href="#hats" title="Permalink to this headline">¶</a></h3>
<p>Once again, a new score instrument is created from a function by
repurposing the code used in <tt class="docutils literal"><span class="pre">kick()</span></tt> and <tt class="docutils literal"><span class="pre">snare()</span></tt> for a hihat:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">hat</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>A second drum pattern called <tt class="docutils literal"><span class="pre">drum_pattern_8th_hats()</span></tt> is created,
a variation on the original drum pattern. In fact, <tt class="docutils literal"><span class="pre">drum_pattern()</span></tt>
is called right in this new function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_8th_hats</span><span class="p">():</span>
    <span class="n">drum_pattern</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span> <span class="n">hat</span><span class="p">()</span>
</pre></div>
</div>
<p>Both patterns are played side by side in the updated score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="post-processing-with-pmap">
<h3>Post Processing with pmap()<a class="headerlink" href="#post-processing-with-pmap" title="Permalink to this headline">¶</a></h3>
<p>Any data entered into the <tt class="docutils literal"><span class="pre">score()</span></tt> object via the <tt class="docutils literal"><span class="pre">PythonScore</span></tt>
<tt class="docutils literal"><span class="pre">write()</span></tt> or <tt class="docutils literal"><span class="pre">i()</span></tt> methods can be treated as data and post-processed
with <tt class="docutils literal"><span class="pre">pmap()</span></tt>. If you ran the last example multiple times, you
might have noticed the &#8220;samples out of range&#8221; warning. This can be
solved on fell swoop. The pmap() function takes the following input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pmap</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">instr</span><span class="p">,</span> <span class="n">pfield</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>To avoid samples being played out of range, all the amplitudes in
the score must be lowered. Multiplying each pfield 4, the amplitude
input for the sampler, with a constant value will do this. First,
let&#8217;s create a function that take two arguments, and returns the
product.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<p>The value of the pfield is passed in as the first arg, x, and 0.707
as y. Pfield 4 is replaced with the value returned by the multipy
function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p>The pmap() function only works on data already in the score. For
this reason, the best place for most cases will be either after the
last even is created and/or at the very end of the score.</p>
</div>
<div class="section" id="pre-processing-events-with-p-callback">
<h3>Pre-processing Events with p_callback()<a class="headerlink" href="#pre-processing-events-with-p-callback" title="Permalink to this headline">¶</a></h3>
<p>The p_callback() method is the pre-processing equivalent of pmap().
The p_callback() registers a function to use with a specific pfield
for a specific instrument, and manipulates data as it is entered
into the score.</p>
<p>As an example, two related set of p_callback()&#8217;s are created. The
first tunes all the drum events up a perfect 5th by altering the
pfield 6 column used for tuning the samples. Since changing the
pitch also affects the length of the sample, which in turn can cause
the more of the sample to bleed into the portion being played, a
second p_callback() modifies the duration by the inverse of the
perfect 5th.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perfect_5th</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">perfect_5th</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">perfect_5th</span><span class="p">)</span>
</pre></div>
</div>
<p>Where these callbacks are placed matter. Typically it is good
practice to place p_callback() functions before any events are
placed in the score. In this example, these are places just prior
to score().</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perfect_5th</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">perfect_5th</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">perfect_5th</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<p>The perfect 5th ratio was hard coded into the last example, but
transposing data is something that is useful enough that it&#8217;s worth
taking the time to consolidate it into a reusable function.</p>
<p>The <tt class="docutils literal"><span class="pre">tranpose()</span></tt> function accepts two args, one which is required
and a second default value. The first arg is the value in halfsteps
in which to transpose. Without a second arg, it outputs a transposition
ratio. If the second arg is supplied, then it will apply the
transposition ratio to this and return the output.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="n">halfstep</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">halfstep</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">score.p_callback()</span></tt> calls are refectored using this new funtion.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="default-values-for-score-instruments">
<h3>Default Values for Score Instruments<a class="headerlink" href="#default-values-for-score-instruments" title="Permalink to this headline">¶</a></h3>
<p>Earlier in the tutorial when score instruments were created for kick() and snare(), the ability to modify duration, amplitude, postion, and sampling tunig was factored out. We&#8217;re going to factor everything except for the position argument back into these score instruments using keyword default values. The keywords for all three instruments are: dur, amp, and tune.</p>
<p>Since these are being refactored back in as keyword default args, all our existing calls to these score instruments will continue to work as is, and we&#8217;re gaining the ability to use these args if we choose to use them.</p>
<p>Here is what the three score instruments look like now they all have default args:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hat</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.35</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that they&#8217;re in, a test drum pattern is in order. This pattern just plays four kicks on the beat, transposed down a perfect 4th.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="n">kick</span><span class="p">(</span><span class="n">tune</span><span class="o">=</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Here&#8217;s the resulting changes to the score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern_2</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="player-instruments">
<h3>Player Instruments<a class="headerlink" href="#player-instruments" title="Permalink to this headline">¶</a></h3>
<p>Functions can also be used to generate gestures. In a sense these are another for of score instruments. The implemented in this example takes as its first argument the function in which we want to play.</p>
<p>Since kick(), snare(), and hat() all have identical signatures for their argument inputs, creating a player instrument that can treat them equally is iis easy.</p>
<p>For the argument, we can pass kick, snare, or hat. The duration of the phrase is passed in as the second arg. The duration of the indivual notes is arg 3. The number of beats to play through the lifespan of the instrument if arg 4. The start_amp and end_amp args do a linear envelop from the first and last nights, which is similiar to the classical score ramp function. And then there is one optional keyword arg for consistant tuning for all samples played by swell().</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">swell</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="n">phrase_dur</span><span class="p">,</span> <span class="n">note_dur</span><span class="p">,</span> <span class="n">n_beats</span><span class="p">,</span> <span class="n">start_amp</span><span class="p">,</span> <span class="n">end_amp</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_amp</span> <span class="o">-</span> <span class="n">start_amp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_beats</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_beats</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_beats</span><span class="p">)</span> <span class="o">*</span> <span class="n">phrase_dur</span><span class="p">):</span>
            <span class="n">instr</span><span class="p">(</span><span class="n">note_dur</span><span class="p">,</span> <span class="n">start_amp</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">inc</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>
</pre></div>
</div>
<p>Wrapping this up into a reuasable phrase:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">intro</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">snare</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">snare</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
<p>Invocation and audio:</p>
</div>
<div class="section" id="algorithmic-flair-drum-pattern">
<h3>Algorithmic Flair Drum Pattern<a class="headerlink" href="#algorithmic-flair-drum-pattern" title="Permalink to this headline">¶</a></h3>
<p>For the last drum pattern of this tutorial, we&#8217;re going to create one that has a bit of an algorithmic flair for randomly generating kicks, snares, and hats.</p>
<p>For this pattern, we&#8217;re going to use the random function from Python&#8217;s random library, which needs to be imported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>
</pre></div>
</div>
<p>The pattern is defiend as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_flair</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">drum_pattern</span><span class="p">()</span>

    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">]</span>
    <span class="n">instrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kick</span><span class="p">,</span> <span class="n">snare</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hat</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
                <span class="n">instr</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">instrs</span><span class="p">)</span>
                <span class="n">instr</span><span class="p">(</span><span class="n">amp</span><span class="o">=</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.125</span><span class="p">)</span>
</pre></div>
</div>
<p>This pattern extends drum_pattern() by calling it first. If any chages are ever made to drum_pattern(), than drum_pattern_flair() would also reflect these changes.</p>
<p>The rest of the pattern works like this. Eight different start times, in beats, are placed in a list. A list of score instrument functions is also created. As a way to increase the probability that a hat() will play, it has been added to this list three times.</p>
<p>It then iterates through the times list. For each of these predeterimined potential start times, it checks a randomly generated number against the input argument r. If the number generated by random() is less than r then a new event is created.</p>
<p>The cue() object is set to the current value of variable time. The choice() functions chooses either kick, snare, hat, hat, or hat. Then the event is created, with a random amplitude in the range os 0.125 and 0.875.</p>
<p>The end result is something common in many drum &#8216;n&#8217; bass tracks in which is sounds as if percussional elements were generated at random, but still has the familiar kick and snare pattern.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_flair</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_flair</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="form-with-functions">
<h3>Form With Functions<a class="headerlink" href="#form-with-functions" title="Permalink to this headline">¶</a></h3>
<p>And finally, a musical example with all the pieces put together. Looking at this code, what do you think the form of the compostion is?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">intro</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span> <span class="n">section_b</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">37</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">53</span><span class="p">):</span> <span class="n">section_c</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">61</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">77</span><span class="p">):</span> <span class="n">section_b</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">93</span><span class="p">):</span> <span class="n">outro</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>So yeah, that&#8217;s it.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="michaeljnelson" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The MST3K guy</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="amen" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Amen break description. Everything from N.W.A. to the Power Puff Girls</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="trashy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>Trashy is a good thing in the right context.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="tracker" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>Trackers are the bee&#8217;s knees</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="dnb" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>Drum&#8217;n&#8217;bass beat</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="snozberry" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[6]</a></td><td>Who&#8217;s every heard of a snozberry?</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fluxcapacitor" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[7]</a></td><td>BTTF</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="adventuretime" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[8]</a></td><td>Episode 3 Season 1</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="darksideofthemoon" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[9]</a></td><td>Which is which</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">CSD</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2009, Jacob Joaquin.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39733073-1', 'github.com');
  ga('send', 'pageview');

</script>

  </body>
</html>