

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Amen Break PythonScore Tutorial &mdash; CSD</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.5 alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="CSD" href="index.html" />
    <link rel="up" title="PythonScore" href="pysco.html" />
    <link rel="next" title="Demos" href="demo/index.html" />
    <link rel="prev" title="PythonScore" href="pysco.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="demo/index.html" title="Demos"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pysco.html" title="PythonScore"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">CSD</a> &raquo;</li>
          <li><a href="pysco.html" accesskey="U">PythonScore</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3>Get CSD</h3>
<ul id="downloadrepo">
    <li><a href="https://github.com/jacobjoaquin/csd/zipball/master">Download <strong>ZIP File</strong></a></li>
    <li><a href="https://github.com/jacobjoaquin/csd/tarball/master">Download <strong>TAR Ball</strong></a></li>
    <li><a href="https://github.com/jacobjoaquin/csd">View On <strong>GitHub</strong></a></li>
</ul>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Amen Break PythonScore Tutorial</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#files">Files</a></li>
<li><a class="reference internal" href="#the-orchestra">The Orchestra</a></li>
<li><a class="reference internal" href="#the-python-interpreter">The Python Interpreter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#classical-score-to-pythonscore">Classical Score to PythonScore</a><ul>
<li><a class="reference internal" href="#upgrade">Upgrade</a></li>
<li><a class="reference internal" href="#time-is-relative">Time is Relative</a></li>
<li><a class="reference internal" href="#measures">Measures</a></li>
<li><a class="reference internal" href="#instrument-event-function">Instrument Event Function</a></li>
<li><a class="reference internal" href="#nesting-time">Nesting Time</a></li>
<li><a class="reference internal" href="#score-instruments">Score Instruments</a></li>
<li><a class="reference internal" href="#drum-pattern">Drum Pattern</a></li>
<li><a class="reference internal" href="#interlude">Interlude</a></li>
<li><a class="reference internal" href="#looping-through-lists">Looping Through Lists</a></li>
<li><a class="reference internal" href="#range">Range</a></li>
<li><a class="reference internal" href="#choice-variation">Choice Variation</a></li>
<li><a class="reference internal" href="#hats">Hats</a></li>
<li><a class="reference internal" href="#post-processing-score-data">Post-Processing Score Data</a></li>
<li><a class="reference internal" href="#pre-processing-score-data">Pre-Processing Score Data</a></li>
<li><a class="reference internal" href="#transpose">Transpose</a></li>
<li><a class="reference internal" href="#default-arguments">Default Arguments</a></li>
<li><a class="reference internal" href="#player-instruments">Player Instruments</a></li>
<li><a class="reference internal" href="#algorithmic-flair">Algorithmic Flair</a></li>
<li><a class="reference internal" href="#form-with-functions">Form With Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pysco.html"
                        title="previous chapter">PythonScore</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="demo/index.html"
                        title="next chapter">Demos</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/amen_tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="amen-break-pythonscore-tutorial">
<h1>Amen Break PythonScore Tutorial<a class="headerlink" href="#amen-break-pythonscore-tutorial" title="Permalink to this headline">¶</a></h1>
<p>By Jacob Joaquin &lt;<a class="reference external" href="mailto:jacobjoaquin&#37;&#52;&#48;gmail&#46;com">jacobjoaquin<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p><em>Updated April 8th, 2013</em></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>PythonScore is a fully modular score environment for the Csound
unified CSD file. Unlike other alternative text-based score
environments, PythonScore is non-imposing and does its best to get
out of the way rather than to impose a strict set of rules for
composition. Classical Csound score is fully supported, all of
Python 2.7 is available, and composers can pick and choose their
score tools <em>à la carte</em> as they see fit.</p>
<p>This purpose of this tutorial is to try and prove the merits of
using the Python language in favor of the classical Csound score.
The classical score is a fixed system while Python is a very mature
and highly extensible language with a vast collection of first and
third party modules. Despite being a general purpose language that
wasn&#8217;t designed for music, Python is particularly well suited for
composition.</p>
<p>PythonScore is not meant as a full replacement of the classical
Csound score, but as an enhancement. Any and all existing classical
score commands still work, and PythonScore itself outputs classical
score code. Perhaps PythonScore should be thought as a user-friendly
higher level abstraction of the classic score.</p>
<p>PythonScore is still early in development, though the library of
use cases and examples is rapidly growing. And all from a single
developer, which will hopefully change soon. The secondary purpose
of this tutorial is to attract a small group of people to start
experimenting with this alternative Csound score environment, to
find out what works, what&#8217;s easy and what&#8217;s not, and to collect new
ideas for future upgrades. It is also the belief of the author that
once people have some hands-on experience, many of the advantages
of working with PythonScore will become obvious. Until then, it&#8217;s
just the ramblings of one person&#8217;s perspective.</p>
<p>Since PythonScore is under development, consider this tutorial a
living document, as it will be updated to keep up with any future
changes. Send questions, comments, and bugs to <a class="reference external" href="mailto:jacobjoaquin&#37;&#52;&#48;gmail&#46;com">jacobjoaquin<span>&#64;</span>gmail<span>&#46;</span>com</a>,
or write to the Csound Mailing List.</p>
<div class="section" id="files">
<h3>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h3>
<p>The Csound CSD files and amen break sample ship with the csd module in:</p>
<div class="highlight-python"><pre>/examples/tutorials/amen/</pre>
</div>
</div>
<div class="section" id="the-orchestra">
<h3>The Orchestra<a class="headerlink" href="#the-orchestra" title="Permalink to this headline">¶</a></h3>
<p>In order to bring focus to the enhanced set of features and
compositional techniques Python with the PythonScore module brings
to the score environment, every example uses the exact same orchestra
throughout the entirety of this tutorial. Let&#8217;s take a look:</p>
<div class="highlight-python"><pre>
sr = 44100
kr = 44100
ksmps = 1
nchnls = 2
0dbfs = 1.0

gS_loop = "amen_break.wav"
gisr filesr gS_loop
gilength filelen gS_loop
gibeats = 16 
gi_sampleleft ftgen 1, 0, 0, 1, gS_loop, 0, 4, 0

instr 1
    idur = p3
    iamp = p4
    ibeat = p5
    itune = p6
    ipos = ibeat / gibeats * gilength * gisr

    aenv linseg iamp, idur - 0.01, iamp, 0.01, 0
    a1, a2 loscilx aenv, itune, 1, 0, 1, ipos, 0
    outs a1, a2
endin

</pre>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_classic.csd"><tt class="xref download docutils literal"><span class="pre">amen_classic.csd</span></tt></a></p>
<p>The orchestra contains only a single instrument, a basic sampler
with the <a class="reference external" href="http://en.wikipedia.org/wiki/Amen_break">Amen Break</a>
as its only audio source. The instrument includes support for three
custom pfield inputs for amplitude, the beat positional sample
offset, and for tuning the sample. The fact that this is only a
very basic instrument is purposeful as techniques discussed in this
tutorial will demonstrate that even simple instruments can be greatly
enhanced with using some of the new techniques afforded by Python.</p>
<p>The output of this sampler has a very trashy quality to it, and
sounds like it was produced with a <a class="reference external" href="http://en.wikipedia.org/wiki/Music_tracker">tracker</a> such as <a class="reference external" href="http://en.wikipedia.org/wiki/FastTracker_2">Fast Tracker
II</a>.</p>
<p>The use of a drum loop is chosen for a very specific reason. The
ability to express occurences in time is a defining attribute of
PythonScore, and percussion-based events are great for honing in
on timing. <em>Do not get the wrong impression that PythonScore caters
to 4/4 drum music, as this is far from the truth.</em></p>
</div>
<div class="section" id="the-python-interpreter">
<h3>The Python Interpreter<a class="headerlink" href="#the-python-interpreter" title="Permalink to this headline">¶</a></h3>
<p>Before diving into the tutorial, an introduction the the <a class="reference external" href="http://docs.python.org/2/tutorial/interpreter.html">Python
Interpreter</a>
is in order as it a wonderful tool for quickly testing various
aspects of the Python language. This tutorial will occasionally embed
examples using it as well.</p>
<p>Typically, the Python interpreter is used in the terminal, which
is invoked by typing &#8220;python&#8221;:</p>
<div class="highlight-python"><pre>Quorra ~ $ python</pre>
</div>
<p>This starts an interactive Python session in which users can begin
entering various commands.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;hello world&#39;</span>
<span class="go">hello world</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">440</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="go">261.6255653005986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
<p>The <a class="reference external" href="http://qutecsound.sourceforge.net/">CsoundQt</a> graphical front
end comes equipped with a Python console. There&#8217;s also <a class="reference external" href="http://ipython.org/">IPython</a> which supercharges the Python Interpreter
with a lot of great features for Python beginners and veterans
alike.</p>
</div>
</div>
<div class="section" id="classical-score-to-pythonscore">
<h2>Classical Score to PythonScore<a class="headerlink" href="#classical-score-to-pythonscore" title="Permalink to this headline">¶</a></h2>
<p>In this section, we&#8217;ll walk you through some the basic
features of Python and PythonScore. The tutorial starts with a classical
Csound score, and adds new PythonScore idioms one by one until
the score as been fully translated. The end result is the new Python
score.</p>
<div class="highlight-python"><pre>
t 0 170

; Measure 1
i 1 0.0 0.5 0.707 0 1
i 1 1.0 0.5 0.707 1 1
i 1 2.5 0.5 0.707 0 1
i 1 3.0 0.5 0.707 1 1

; Measure 2
i 1 4.0 0.5 0.707 0 1
i 1 5.0 0.5 0.707 1 1
i 1 6.5 0.5 0.707 0 1
i 1 7.0 0.5 0.707 1 1

; Measure 3
i 1 8.0  0.5 0.707 0 1
i 1 9.0  0.5 0.707 1 1
i 1 10.5 0.5 0.707 0 1
i 1 11.0 0.5 0.707 1 1

; Measure 4
i 1 12.0 0.5 0.707 0 1
i 1 13.0 0.5 0.707 1 1
i 1 14.5 0.5 0.707 0 1
i 1 15.0 0.5 0.707 1 1

</pre>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_classic.csd"><tt class="xref download docutils literal"><span class="pre">amen_classic.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990916"></iframe><p>The score code produces four measures of the same drum pattern. The
pattern itself is the classical <a class="reference external" href="http://en.wikipedia.org/wiki/Drum_and_bass">drum &#8216;n&#8217; bass</a>.</p>
<div class="section" id="upgrade">
<h3>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h3>
<p>Porting a classical score into the Python requires a few lines of
code to set up. First, set the argument of the CsScore bin utility
to &#8220;python&#8221;. Then import PythonScore:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
</pre></div>
</div>
<p>An object called <tt class="docutils literal"><span class="pre">score</span></tt> is instantiated from the <tt class="docutils literal"><span class="pre">PythonScore()</span></tt>
class. Additionally, variable <tt class="docutils literal"><span class="pre">cue</span></tt> is created and points to the
<tt class="docutils literal"><span class="pre">score.cue</span></tt> context manager. We&#8217;ll go into details later as to
why. Classical Csound source code is entered into the <tt class="docutils literal"><span class="pre">score()</span></tt>
object via the <tt class="docutils literal"><span class="pre">write()</span></tt> method. And last, add <tt class="docutils literal"><span class="pre">score.end()</span></tt>
as the last statement in the score to tell PythonScore that it&#8217;s
ready to generate the classical Csound score code and pass it to
Csound. The result is this new score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">CsScore</span> <span class="nb">bin</span><span class="o">=</span><span class="s">&quot;python&quot;</span><span class="o">&gt;</span>

<span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">t 0 170</span>

<span class="s">; Measure 1</span>
<span class="s">i 1 0.0 0.5 0.707 0 1</span>
<span class="s">i 1 1.0 0.5 0.707 1 1</span>
<span class="s">i 1 2.5 0.5 0.707 0 1</span>
<span class="s">i 1 3.0 0.5 0.707 1 1</span>

<span class="s">; Measure 2</span>
<span class="s">i 1 4.0 0.5 0.707 0 1</span>
<span class="s">i 1 5.0 0.5 0.707 1 1</span>
<span class="s">i 1 6.5 0.5 0.707 0 1</span>
<span class="s">i 1 7.0 0.5 0.707 1 1</span>

<span class="s">; Measure 3</span>
<span class="s">i 1 8.0  0.5 0.707 0 1</span>
<span class="s">i 1 9.0  0.5 0.707 1 1</span>
<span class="s">i 1 10.5 0.5 0.707 0 1</span>
<span class="s">i 1 11.0 0.5 0.707 1 1</span>

<span class="s">; Measure 4</span>
<span class="s">i 1 12.0 0.5 0.707 0 1</span>
<span class="s">i 1 13.0 0.5 0.707 1 1</span>
<span class="s">i 1 14.5 0.5 0.707 0 1</span>
<span class="s">i 1 15.0 0.5 0.707 1 1</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>

<span class="o">&lt;/</span><span class="n">CsScore</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">CsoundSynthesizer</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_upgrade.csd"><tt class="xref download docutils literal"><span class="pre">amen_upgrade.csd</span></tt></a></p>
<p>If this worries you that you&#8217;ll be required to throw out everything
you know about the classic Csound score, fear not as you can still
use it with the <tt class="docutils literal"><span class="pre">score()</span></tt> object virtually untouched, or in
combination with other Python features as you learn them.</p>
</div>
<div class="section" id="time-is-relative">
<h3>Time is Relative<a class="headerlink" href="#time-is-relative" title="Permalink to this headline">¶</a></h3>
<p>For the most part, when events are entered into a classical Csound
score, the start times are in global beats. PythonScore changes
this with by introduction of the <tt class="docutils literal"><span class="pre">cue()</span></tt> object, a Python <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#typecontextmanager">context
manager</a> for
moving the current position time in the score. Like a needle on a
record. All events entered into PythonScore are relative the current
positional value of <tt class="docutils literal"><span class="pre">cue()</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">score</span><span class="p">(</span><span class="s">&#39;i 1 0 0.5 0.707 0 0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>While the start time value in pfield-2 is 0, this event will start
at 12 beats into the piece. This is because start time events are
processed to reflect the current position of the cue(). The output
looks like this:</p>
<div class="highlight-python"><pre>i 1 12 0.5 0.707 0 0</pre>
</div>
<p>Remember when we set <tt class="docutils literal"><span class="pre">cue</span> <span class="pre">=</span> <span class="pre">score.cue</span></tt> earlier? This was done to
create a shorthand version to eliminate having to specify the full
score object and method.</p>
<p>As for translating the drum &#8216;n&#8217; bass parts, each measure has been
split into its own chuck of events. The first event in measure 2
has been changed to 0.0, and the same goes for measures 3 and 4.
The <tt class="docutils literal"><span class="pre">cue()</span></tt> object allows the composer locally to the current
measure, rather than manually calculating the global time at all
times.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_cue.csd"><tt class="xref download docutils literal"><span class="pre">amen_cue.csd</span></tt></a></p>
<p>There are of course many more benefits. For example, moving entire
sections of code is a fairly trivial process in PythonScore. Doing
the same in the classical score could require translating start
times down a long pfield-2 column. It is the assertion of the author
that this feature, and this feature alone, makes transitioning to
PythonScore more than worthwhile.</p>
</div>
<div class="section" id="measures">
<h3>Measures<a class="headerlink" href="#measures" title="Permalink to this headline">¶</a></h3>
<p>The drum &#8216;n&#8217; bass score is in 4/4. While <tt class="docutils literal"><span class="pre">cue()</span></tt> allows us to
treat beats local to the current measure, the arguments for the
cue() are still in absolute global time. Out of the box, PythonScore
does not support measures. However, Python is highly extensible and
lets you <em>roll your own</em>. Implementing 4/4 measures is done by
<a class="reference external" href="http://docs.python.org/2/tutorial/controlflow.html#defining-functions">defining a new function</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
<p>This two line custom function takes the measure number as its sole
argument and translates measure time to beat time, and returns an
instance of cue().</p>
<p>Let&#8217;s focus little on the math. The global score starts at 0, but
measures start at 1. The is overcome with an offset of -1. In 4/4,
there are four beats per measure, which requires the offset value
to be multiplied by 4. Testing the math in the Python Interpreter
with inputting 4:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test_measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_measure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">12.0</span>
</pre></div>
</div>
<p>Inputting 4 into our test the value returned is 12, which is the
starting time of the first event in measure 4 in the original
classical score. Applying <tt class="docutils literal"><span class="pre">measure()</span></tt> to the PythonScore, were
left with the following. Notice that the comments have been factored
out now that the code itself clearly indicates what a measure is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">    i 1 0.0 0.5 0.707 0 1</span>
<span class="s">    i 1 1.0 0.5 0.707 1 1</span>
<span class="s">    i 1 2.5 0.5 0.707 0 1</span>
<span class="s">    i 1 3.0 0.5 0.707 1 1</span>
<span class="s">    &#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_measure.csd"><tt class="xref download docutils literal"><span class="pre">amen_measure.csd</span></tt></a></p>
</div>
<div class="section" id="instrument-event-function">
<h3>Instrument Event Function<a class="headerlink" href="#instrument-event-function" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">score.i()</span></tt> method is another way for entering in data into
the score. Instead of a string, it accepts any number of arguments
and constructs a valid classical score event string. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><pre>i 1 0 1 0.707 8.00</pre>
</div>
<p>Replacing the calls to <tt class="docutils literal"><span class="pre">score.write()</span></tt> with the <tt class="docutils literal"><span class="pre">i()</span></tt> method in the Amen score, the
updated code looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_i.csd"><tt class="xref download docutils literal"><span class="pre">amen_i.csd</span></tt></a></p>
</div>
<div class="section" id="nesting-time">
<h3>Nesting Time<a class="headerlink" href="#nesting-time" title="Permalink to this headline">¶</a></h3>
<p>A <tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statement can be placed inside a hierarchy of other
<tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statements. This allows composers to reset the
relative positional time to zero regardless of the current scope of
time by writing another <tt class="docutils literal"><span class="pre">with</span> <span class="pre">cue()</span></tt> statement: For example, this
is possible:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Though the start time of the event is written as 0, the actual start
time of the event is 37, which is the accumulation of all the args
in the cue nesting hierarchy plus pfield-2: <tt class="docutils literal"><span class="pre">32</span> <span class="pre">+</span> <span class="pre">4</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">0</span></tt></p>
<p>The greater implication is that time can be completely decoupled
from events. In this version of the score the start times are moved
from the pfield-2 column to the the <tt class="docutils literal"><span class="pre">cue()</span></tt>, and then set to 0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_nest.csd"><tt class="xref download docutils literal"><span class="pre">amen_nest.csd</span></tt></a></p>
</div>
<div class="section" id="score-instruments">
<h3>Score Instruments<a class="headerlink" href="#score-instruments" title="Permalink to this headline">¶</a></h3>
<p>Composers can create named Python functions that call their
corresponding orchestra instruments. Furthermore, multiple functions
can be created for the same instrument, but with more specific
intent as to what the resultant behavior of the instrument is, like
a patch.</p>
<p>The sampler instrument in the orchestra is fairly simple and generic
in design. While the Amen Break loop is fixed, the instrument itself
has no knowledge of kicks or snares. It only accesses the part of
the sample denoted by the beat positional offset passed into pfield-5.</p>
<p>Looking at the PythonScore code from the last example, there are
only two unique calls to <tt class="docutils literal"><span class="pre">score.i()</span></tt>, and even then all the
arguments are identical except for pfield-5:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The former plays a kick drum while the latter plays a snare. Though
looking at the code <em>who knows which is which and who is
who</em>. <a class="footnote-reference" href="#darksideofthemoon" id="id1">[1]</a> This is because the classic Csound events
are more or less just data, and don&#8217;t naturally signify what&#8217;s
behind the data.</p>
<p>These statements are also unnecessarily long in Python, which makes
them ripe to for consolidation. Defining functions for the kick and
snare avoids the extra overhead by factoring out all the args.
Something is made possible by the <tt class="docutils literal"><span class="pre">cue()</span></tt> object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>An equally important benefit to this approach is that with proper
names, this technique creates code that is self documenting and
easier to read. If you type <tt class="docutils literal"><span class="pre">kick()</span></tt> it plays a kick. Type
<tt class="docutils literal"><span class="pre">snare()</span></tt> it plays a snare. Type <tt class="docutils literal"><span class="pre">snozberry()</span></tt> it plays a
snozberry(). <a class="footnote-reference" href="#snozberry" id="id2">[2]</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_instr.csd"><tt class="xref download docutils literal"><span class="pre">amen_instr.csd</span></tt></a></p>
</div>
<div class="section" id="drum-pattern">
<h3>Drum Pattern<a class="headerlink" href="#drum-pattern" title="Permalink to this headline">¶</a></h3>
<p>The score contains four measures that contain identical content.
Functions can store musical phrases, everything from a single note
to complete works of Beethoven if necessary. In this case, we have
a simple four notes drum &#8216;n&#8217; bass pattern.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
</pre></div>
</div>
<p>These events will not be generated until the function is called.
For each measure, four lines of score instruments is replaced with
<tt class="docutils literal"><span class="pre">drum_pattern()</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">csd.pysco</span> <span class="kn">import</span> <span class="n">PythonScore</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cue</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">drum_pattern</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.5</span><span class="p">):</span> <span class="n">kick</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="n">snare</span><span class="p">()</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">PythonScore</span><span class="p">()</span>
<span class="n">cue</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">cue</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_pattern.csd"><tt class="xref download docutils literal"><span class="pre">amen_pattern.csd</span></tt></a></p>
<p>Functions aren&#8217;t limited to storing measures of data. Notes, licks,
phrases, bars, sections, scores, can all be placed inside a function.
Later when it&#8217;s time to start arranging, musical patterns like these
can be more or less dropped into <tt class="docutils literal"><span class="pre">measure()</span></tt> blocks.</p>
</div>
<div class="section" id="interlude">
<h3>Interlude<a class="headerlink" href="#interlude" title="Permalink to this headline">¶</a></h3>
<p>The score we&#8217;re left with is fundamentally more expressive and more
readable than the original Csound score. Even if all the intricacies
of Python may still a mystery, reading through the code you should
be able to pick up on the instrumentation as well as seeing that
the score is divided into measures.</p>
<p>In the examples to come, new features and musical phrases are built
on top of the existing work covered in the previous examples. The
orchestra will remain unchanged, though the music will. Some of
these new idioms are more complex, so it worth playing with what
has be presented thus far. Though do read on even if you just skim
that material to get a sense as to what other compositional advantages
that Python brings to composing with code.</p>
</div>
<div class="section" id="looping-through-lists">
<h3>Looping Through Lists<a class="headerlink" href="#looping-through-lists" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference external" href="http://docs.python.org/2/library/functions.html?highlight=list#list">Python list</a> is
a container for storing various data, which may include numbers,
strings, other lists, functions, etc. And they make a wonderful
additional to the score environment. They&#8217;re highly versatile and
time saving. This example is a list of integers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>A loop is created from a list with the <a class="reference external" href="http://docs.python.org/2/tutorial/controlflow.html#for-statements">for</a>
statement, as it will iterate through each value. In the score as
the <tt class="docutils literal"><span class="pre">for</span></tt> loop iterates through the list, the <tt class="docutils literal"><span class="pre">m</span></tt> variable
assumes the the value of the current list item. This is shorthand
for calling <tt class="docutils literal"><span class="pre">drum_pattern()</span></tt> for measures 1 through 4:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_list.csd"><tt class="xref download docutils literal"><span class="pre">amen_list.csd</span></tt></a></p>
</div>
<div class="section" id="range">
<h3>Range<a class="headerlink" href="#range" title="Permalink to this headline">¶</a></h3>
<p>The Python <a class="reference external" href="http://docs.python.org/2/tutorial/controlflow.html#the-range-function">range()</a>
generates lists of integers automatically and is useful in a range
of different contexts. Here are three examples of lists generated
with <tt class="docutils literal"><span class="pre">range()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">[4, 5, 6, 7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[0, 4, 8, 12, 16, 20, 24, 28]</span>
</pre></div>
</div>
<p>Substituting that manually created list with <tt class="docutils literal"><span class="pre">range()</span></tt> leaves us
with this score update.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_range.csd"><tt class="xref download docutils literal"><span class="pre">amen_range.csd</span></tt></a></p>
</div>
<div class="section" id="choice-variation">
<h3>Choice Variation<a class="headerlink" href="#choice-variation" title="Permalink to this headline">¶</a></h3>
<p>Python comes with the <a class="reference external" href="http://docs.python.org/2/library/random.html">random module</a> which includes the
<a class="reference external" href="http://docs.python.org/2/library/random.html#random.choice">choice()</a>
function that returns a random value from a list. Prior to this
example, all kick and snare events use the same sample from the
Amen break. Applied to the <tt class="docutils literal"><span class="pre">kick()</span></tt> and <tt class="docutils literal"><span class="pre">snare()</span></tt> score
instruments, these functions randomly choose samples from a fixed
list of beat positional offsets in the drum loop.</p>
<p>The <tt class="docutils literal"><span class="pre">kick()</span></tt> function chooses from positions 0, 0.5, 4, and 4.5:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">snare()</span></tt> functions chooses from positions 1, 3, 5, and 7:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">snare</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_choice.csd"><tt class="xref download docutils literal"><span class="pre">amen_choice.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990915"></iframe></div>
<div class="section" id="hats">
<h3>Hats<a class="headerlink" href="#hats" title="Permalink to this headline">¶</a></h3>
<p>Once again, a new score instrument is created from a function by
re purposing the code used in <tt class="docutils literal"><span class="pre">kick()</span></tt> and <tt class="docutils literal"><span class="pre">snare()</span></tt> for a hihat:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">hat</span><span class="p">():</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>A second drum pattern called <tt class="docutils literal"><span class="pre">drum_pattern_8th_hats()</span></tt> is created,
a variation on the original drum pattern. In fact, <tt class="docutils literal"><span class="pre">drum_pattern()</span></tt>
is called right in this new function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_8th_hats</span><span class="p">():</span>
    <span class="n">drum_pattern</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span> <span class="n">hat</span><span class="p">()</span>
</pre></div>
</div>
<p>Both patterns are played side by side in the updated score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_hats.csd"><tt class="xref download docutils literal"><span class="pre">amen_hats.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990921"></iframe></div>
<div class="section" id="post-processing-score-data">
<h3>Post-Processing Score Data<a class="headerlink" href="#post-processing-score-data" title="Permalink to this headline">¶</a></h3>
<p>Any data entered into the <tt class="docutils literal"><span class="pre">score()</span></tt> object via the <tt class="docutils literal"><span class="pre">PythonScore</span></tt>
<tt class="docutils literal"><span class="pre">write()</span></tt> or <tt class="docutils literal"><span class="pre">i()</span></tt> methods can be treated as data and post-processed
with <tt class="docutils literal"><span class="pre">pmap()</span></tt>. If you ran the last example multiple times, you
might have noticed the <em>&#8220;samples out of range&#8221;</em> warning. This can
be solved in fell swoop. The <tt class="docutils literal"><span class="pre">pmap()</span></tt> method takes the following
input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pmap</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">instr</span><span class="p">,</span> <span class="n">pfield</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>To avoid samples being played out of range, all the amplitudes in
the score are lowered. Pfield-4 is designated for amplitude, and
each value in the pfield-4 column multiplied by a constant value.
The process uses a custom definition for returning the product of
two numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<p>The value of the pfield is passed in as the first arg <cite>x</cite> and 0.707
as <cite>y</cite>. Pfield-4 is replaced with the value returned by the <cite>multiply()</cite>
function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_postprocess.csd"><tt class="xref download docutils literal"><span class="pre">amen_postprocess.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990923"></iframe><p>The <cite>pmap()</cite> function only works on data already in the score. For
this reason, the best place for most cases will be either after the
last event is generated and/or just before <tt class="docutils literal"><span class="pre">score.end()</span></tt> is called.</p>
</div>
<div class="section" id="pre-processing-score-data">
<h3>Pre-Processing Score Data<a class="headerlink" href="#pre-processing-score-data" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">p_callback()</span></tt> method is the pre-processing equivalent of <tt class="docutils literal"><span class="pre">pmap()</span></tt>.
The <tt class="docutils literal"><span class="pre">p_callback()</span></tt> method registers a function to use with a specific pfield
for a specific instrument, and manipulates data as it is entered
into the score.</p>
<p>As an example, two related set of <tt class="docutils literal"><span class="pre">p_callback()</span></tt> functions are
created. The first tunes all the drum events up a perfect 5th by
altering the pfield-6 column used for tuning the samples. Since
changing the pitch also affects the length of the sample, which in
turn can cause the more of the sample to bleed into the next sample
in the audio file, a second <tt class="docutils literal"><span class="pre">p_callback()</span></tt> modifies the duration
by the inverse of a perfect 5th.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perfect_5th</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">perfect_5th</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">perfect_5th</span><span class="p">)</span>
</pre></div>
</div>
<p>Where these callbacks are placed matter. Typically it is good
practice to place <tt class="docutils literal"><span class="pre">p_callback()</span></tt> functions before any events are
placed in the score. In this example, these are placed just prior
to the first write to the <tt class="docutils literal"><span class="pre">score()</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perfect_5th</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">perfect_5th</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">perfect_5th</span><span class="p">)</span>

<span class="n">score</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t 0 170&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>

<span class="n">score</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">)</span>
<span class="n">score</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_preprocess.csd"><tt class="xref download docutils literal"><span class="pre">amen_preprocess.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990924"></iframe></div>
<div class="section" id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<p>The perfect 5th ratio was hard coded into the last example, but
transposing data is something that is useful enough that it&#8217;s worth
taking the time to consolidate it into a reusable function.</p>
<p>The <tt class="docutils literal"><span class="pre">transpose()</span></tt> function accepts two args, one which is required
and a second optional default argument. The first arg is the value
in half steps in which to transpose. Without a second arg, it outputs
the ratio of transposition.  If the second arg is supplied, then
it will apply the transposition ratio to this before returning the
output.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="n">halfstep</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">halfstep</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">score.p_callback()</span></tt> calls are refactored using this new function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="n">score</span><span class="o">.</span><span class="n">p_callback</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_transpose.csd"><tt class="xref download docutils literal"><span class="pre">amen_transpose.csd</span></tt></a></p>
</div>
<div class="section" id="default-arguments">
<h3>Default Arguments<a class="headerlink" href="#default-arguments" title="Permalink to this headline">¶</a></h3>
<p>Earlier in the tutorial when <tt class="docutils literal"><span class="pre">kick()</span></tt>, <tt class="docutils literal"><span class="pre">snare()</span></tt>, and <tt class="docutils literal"><span class="pre">hat()</span></tt>
were created, the instr number, start time, duration, amplitude,
beat positional offset, and tuning were factored out of the interface.
Three of these are put back in as optional arguments: duration,
amplitude, and tuning. Since these are optional arguments, we can
continue using the existing short form. Here are the updated score
instruments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kick</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">snare</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hat</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="mf">0.35</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="mf">0.707</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">dur</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">tune</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">])</span>
    <span class="n">score</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dur</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>
</pre></div>
</div>
<p>A new pattern is created that plays four kicks on the beat transposed
down a perfect fourth.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="n">kick</span><span class="p">(</span><span class="n">tune</span><span class="o">=</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Here is <tt class="docutils literal"><span class="pre">drum_pattern_2()</span></tt> tested in context with two other
patterns:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern_2</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_default_args.csd"><tt class="xref download docutils literal"><span class="pre">amen_default_args.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990917"></iframe></div>
<div class="section" id="player-instruments">
<h3>Player Instruments<a class="headerlink" href="#player-instruments" title="Permalink to this headline">¶</a></h3>
<p>Python functions can accept other functions as arguments. This is
taken advantage of in this example as we create a generic player
instrument that accepts either <tt class="docutils literal"><span class="pre">kick</span></tt>, <tt class="docutils literal"><span class="pre">snare</span></tt>, or <tt class="docutils literal"><span class="pre">hat</span></tt> as
the first argument, then plays the passed score instrument based
on the the proceeding arguments. This is possible since our score
instruments have identical interfaces/signatures.</p>
<p>The player instrument is named <tt class="docutils literal"><span class="pre">swell()</span></tt> as it was originally
envisioned as way to play instruments with ramped amplitudes. Here
is a description of the rest of the arguments in order in which
they appear:</p>
<blockquote>
<div><ul class="simple">
<li>The duration of that phrase in beats.</li>
<li>The duration of the individual instrument events.</li>
<li>The number of beats to play through the lifespan of the player.</li>
<li>The amplitude of the first note.</li>
<li>The amplitude of the target last note.</li>
<li>Optional arg for tuning.</li>
</ul>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">swell</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="n">phrase_dur</span><span class="p">,</span> <span class="n">note_dur</span><span class="p">,</span> <span class="n">n_beats</span><span class="p">,</span> <span class="n">start_amp</span><span class="p">,</span> <span class="n">end_amp</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_amp</span> <span class="o">-</span> <span class="n">start_amp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_beats</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_beats</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_beats</span><span class="p">)</span> <span class="o">*</span> <span class="n">phrase_dur</span><span class="p">):</span>
            <span class="n">instr</span><span class="p">(</span><span class="n">note_dur</span><span class="p">,</span> <span class="n">start_amp</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">inc</span><span class="p">,</span> <span class="n">tune</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a new pattern that utilizes the new player instrument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">intro</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">snare</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">kick</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="n">swell</span><span class="p">(</span><span class="n">hat</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">swell</span><span class="p">(</span><span class="n">snare</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">transpose</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_player.csd"><tt class="xref download docutils literal"><span class="pre">amen_player.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990922"></iframe></div>
<div class="section" id="algorithmic-flair">
<h3>Algorithmic Flair<a class="headerlink" href="#algorithmic-flair" title="Permalink to this headline">¶</a></h3>
<p>For the last drum pattern of this tutorial, we&#8217;re going to create
one that has a bit of an algorithmic flair for randomly generating
kicks, snares, and hats. For this pattern, we&#8217;re going to use the
<a class="reference external" href="http://docs.python.org/2/library/random.html#random.random">random function</a> from
Python&#8217;s random module, which is imported near the top of the score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>
</pre></div>
</div>
<p>The new pattern is called <tt class="docutils literal"><span class="pre">drum_pattern_flair()</span></tt> and looks like
this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">drum_pattern_flair</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">drum_pattern</span><span class="p">()</span>

    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">]</span>
    <span class="n">instrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kick</span><span class="p">,</span> <span class="n">snare</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hat</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">cue</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
                <span class="n">instr</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">instrs</span><span class="p">)</span>
                <span class="n">instr</span><span class="p">(</span><span class="n">amp</span><span class="o">=</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.125</span><span class="p">)</span>
</pre></div>
</div>
<p>The pattern excepts an optional argument <tt class="docutils literal"><span class="pre">r</span></tt> that determines the
odds of an event being randomly generated. If <tt class="docutils literal"><span class="pre">r</span></tt> is 0, then there
is no chance that extra notes will be played. When <tt class="docutils literal"><span class="pre">r</span></tt> is set to
1, it&#8217;ll generate an event every chance it gets.</p>
<p>The pattern uses the original <tt class="docutils literal"><span class="pre">drum_pattern()</span></tt> created earlier,
and then continues with some programming logic to add a bit of
algorithmic flair to it. A list is created with eight different
start times (in beats). A second list containing a list of score
instruments is created; Only one kick and snare are added, but
includes hat three times to increase the odds that this will be
chosen.</p>
<p>Using the <tt class="docutils literal"><span class="pre">for</span></tt> loop, the program iterates through each value in
list <tt class="docutils literal"><span class="pre">times</span></tt>. It does a comparison to a randomly generated number
for each. If the random number is less than <tt class="docutils literal"><span class="pre">r</span></tt>, then a score
instrument is generated for the current value of <tt class="docutils literal"><span class="pre">time</span></tt>. The
<tt class="docutils literal"><span class="pre">cue()</span></tt> is set to the current value of variable <tt class="docutils literal"><span class="pre">time</span></tt>. The
<tt class="docutils literal"><span class="pre">choice()</span></tt> functions then chooses either kick, snare, hat, hat,
or hat. Then the event is created, with a random amplitude in the
range of 0.125 and 0.875.</p>
<p>The end result is the original drum pattern plus some extra random
notes, maybe.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">drum_pattern</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">drum_pattern_flair</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">drum_pattern_8th_hats</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">drum_pattern_flair</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_flair.csd"><tt class="xref download docutils literal"><span class="pre">amen_flair.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990918"></iframe></div>
<div class="section" id="form-with-functions">
<h3>Form With Functions<a class="headerlink" href="#form-with-functions" title="Permalink to this headline">¶</a></h3>
<p>In this final example, rather adding a feature we&#8217;re going to make
a point about readability. Look at this snippet of code from the
final score and see if you can figure out the form?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">intro</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span> <span class="n">section_b</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">37</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">53</span><span class="p">):</span> <span class="n">section_c</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">61</span><span class="p">):</span> <span class="n">section_a</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">77</span><span class="p">):</span> <span class="n">section_b</span><span class="p">()</span>
<span class="k">with</span> <span class="n">measure</span><span class="p">(</span><span class="mi">93</span><span class="p">):</span> <span class="n">outro</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Source:</strong> <a class="reference download internal" href="_downloads/amen_form.csd"><tt class="xref download docutils literal"><span class="pre">amen_form.csd</span></tt></a></p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F86990919"></iframe><p>Granted, not all scores are built the same, and Python definitely
allows the creation of some horrendous code. Though the code can
also be used to bring greater clarity to the score.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="darksideofthemoon" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Pink Floyd, &#8220;Us and Them&#8221;, The Dark Side of the Moon, 1973</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="snozberry" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Willy Wonka and the Chocolate Factory, movie, 1971</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="demo/index.html" title="Demos"
             >next</a> |</li>
        <li class="right" >
          <a href="pysco.html" title="PythonScore"
             >previous</a> |</li>
        <li><a href="index.html">CSD</a> &raquo;</li>
          <li><a href="pysco.html" >PythonScore</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2009, Jacob Joaquin.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39733073-1', 'github.com');
  ga('send', 'pageview');

</script>

  </body>
</html>